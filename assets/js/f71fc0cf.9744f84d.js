"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[45792],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>m});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=o.createContext({}),c=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=c(e.components);return o.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,h=d["".concat(p,".").concat(m)]||d[m]||u[m]||r;return n?o.createElement(h,i(i({ref:t},l),{},{components:n})):o.createElement(h,i({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<r;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},24201:(e,t,n)=>{n.r(t),n.d(t,{frontMatter:()=>s,contentTitle:()=>p,metadata:()=>c,toc:()=>l,default:()=>d});var o=n(87462),a=n(63366),r=(n(67294),n(3905)),i=["components"],s={id:"the-basics-actions",title:"Bottender Actions",original_id:"the-basics-actions"},p=void 0,c={unversionedId:"the-basics-actions",id:"version-1.3.1/the-basics-actions",isDocsHomePage:!1,title:"Bottender Actions",description:"Bottender actions are the smallest building blocks of Bottender apps. An action describes what you want your bot to do when receiving an event:",source:"@site/versioned_docs/version-1.3.1/the-basics-actions.md",sourceDirName:".",slug:"/the-basics-actions",permalink:"/docs/1.3.1/the-basics-actions",editUrl:"https://github.com/Yoctol/bottender/edit/master/docs/versioned_docs/version-1.3.1/the-basics-actions.md",tags:[],version:"1.3.1",lastUpdatedBy:"\u5433\u6771\u66c4 Wu, Dung-Ie",lastUpdatedAt:1636542901,formattedLastUpdatedAt:"11/10/2021",frontMatter:{id:"the-basics-actions",title:"Bottender Actions",original_id:"the-basics-actions"},sidebar:"version-1.3.1/docs",previous:{title:"Console Mode",permalink:"/docs/1.3.1/the-basics-console-mode"},next:{title:"Routing",permalink:"/docs/1.3.1/the-basics-routing"}},l=[{value:"Composing Actions",id:"composing-actions",children:[],level:2},{value:"Passing Props to Actions",id:"passing-props-to-actions",children:[],level:2},{value:"How to Debug Actions",id:"how-to-debug-actions",children:[],level:2}],u={toc:l};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Bottender actions")," are the smallest building blocks of Bottender apps. An action describes what you want your bot to do when receiving an event:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"async function SayHi(context) {\n  await context.sendText('Hi!');\n}\n")),(0,r.kt)("p",null,"A typical action takes ",(0,r.kt)("inlineCode",{parentName:"p"},"context")," as the first argument. The ",(0,r.kt)("inlineCode",{parentName:"p"},"context")," variable provides the data in the conversation context and various methods to interact with the user. You can use those data and methods to build your actions. For example, you may create an ",(0,r.kt)("inlineCode",{parentName:"p"},"Echo")," action to reply with the text it receives to the user using ",(0,r.kt)("inlineCode",{parentName:"p"},"context.sendText(context.event.text)"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"async function Echo(context) {\n  if (context.event.isText) {\n    await context.sendText(context.event.text);\n  }\n}\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:")," The ",(0,r.kt)("inlineCode",{parentName:"p"},"context")," variable provides methods differently among platforms. You can apply a progressive enhancement strategy using platform-specific methods.")),(0,r.kt)("h2",{id:"composing-actions"},"Composing Actions"),(0,r.kt)("p",null,"Bottender actions are composable. Actions can refer to other actions as their return value."),(0,r.kt)("p",null,"For example, you may use the ",(0,r.kt)("inlineCode",{parentName:"p"},"SayHi")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Unknown")," action to create another ",(0,r.kt)("inlineCode",{parentName:"p"},"App")," action:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"async function SayHi(context) {\n  await context.sendText('Hi!');\n}\n\nasync function Unknown(context) {\n  await context.sendText('Sorry.');\n}\n\nasync function App(context) {\n  if (context.event.text == 'hi') {\n    return SayHi;\n  }\n  return Unknown;\n}\n")),(0,r.kt)("p",null,"If the ",(0,r.kt)("inlineCode",{parentName:"p"},"App"),' action receives a "hi" text message, it replies with a "Hi!" text message. Otherwise, the ',(0,r.kt)("inlineCode",{parentName:"p"},"App"),' action replies with a "Sorry." text message.'),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:")," New Bottender apps created by Create Bottender App have an ",(0,r.kt)("inlineCode",{parentName:"p"},"App")," action as an entry point in the ",(0,r.kt)("inlineCode",{parentName:"p"},"src/index.js")," file. However, if you are familiar with Bottender, you may rename the action or even use different structure instead.")),(0,r.kt)("h2",{id:"passing-props-to-actions"},"Passing Props to Actions"),(0,r.kt)("p",null,"In the above examples, the actions only take one argument ",(0,r.kt)("inlineCode",{parentName:"p"},"context"),". However, you can utilize the second argument - ",(0,r.kt)("inlineCode",{parentName:"p"},"props")," to define your actions with flexibility in mind:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"async function SayHi(context, props) {\n  await context.sendText(`Hi, ${props.name}.`);\n}\n")),(0,r.kt)("p",null,"Instead of returning the action directly without ",(0,r.kt)("inlineCode",{parentName:"p"},"props"),", you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"withProps")," function to provide an object as ",(0,r.kt)("inlineCode",{parentName:"p"},"props")," for the action:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { withProps } = require('bottender');\n\nasync function App(context) {\n  return withProps(SayHi, { name: 'Bob' });\n}\n")),(0,r.kt)("p",null,"Bottender provides ",(0,r.kt)("inlineCode",{parentName:"p"},"{ name: 'Bob' }")," as ",(0,r.kt)("inlineCode",{parentName:"p"},"props")," for the ",(0,r.kt)("inlineCode",{parentName:"p"},"SayHi"),' action, so your bot replies the "Hi, Bob." text message as a result to the user.'),(0,r.kt)("h2",{id:"how-to-debug-actions"},"How to Debug Actions"),(0,r.kt)("p",null,"Bottender uses the famous ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/debug"},"debug")," package internally to collect some helpful information that can be showed up when you provide the corresponding ",(0,r.kt)("inlineCode",{parentName:"p"},"DEBUG")," environment variable. To debug your actions, you may run your command with ",(0,r.kt)("inlineCode",{parentName:"p"},"DEBUG=bottender:action"),", for example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"DEBUG=bottender:action npm start\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:")," If you are developing your bots on Windows, you may use the ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/cross-env"},"cross-env")," package to assign the ",(0,r.kt)("inlineCode",{parentName:"p"},"DEBUG")," environment variable:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"cross-env DEBUG=bottender:action npm start\n")),(0,r.kt)("p",null,"Or you may put your ",(0,r.kt)("inlineCode",{parentName:"p"},"DEBUG")," environment setting into your ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"DEBUG=bottender:action\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/3382565/70204869-0dd9db00-175d-11ea-814f-140b3807f39d.gif",alt:null})),(0,r.kt)("p",null,"We recommend that you always name your actions, so Bottender prints meaningful paths for you to debug instead of showing ",(0,r.kt)("inlineCode",{parentName:"p"},"Anonymous")," as the action name."))}d.isMDXComponent=!0}}]);