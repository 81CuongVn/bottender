"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[30732],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,s=e.originalType,l=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),u=p(n),d=i,h=u["".concat(l,".").concat(d)]||u[d]||m[d]||s;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var s=n.length,o=new Array(s);o[0]=u;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r.mdxType="string"==typeof e?e:i,o[1]=r;for(var p=2;p<s;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7092:(e,t,n)=>{n.r(t),n.d(t,{frontMatter:()=>r,contentTitle:()=>l,metadata:()=>p,toc:()=>c,default:()=>u});var a=n(87462),i=n(63366),s=(n(67294),n(3905)),o=["components"],r={id:"channel-messenger-sending-messages",title:"Sending Messenger Messages",original_id:"channel-messenger-sending-messages"},l=void 0,p={unversionedId:"channel-messenger-sending-messages",id:"version-1.0.5/channel-messenger-sending-messages",isDocsHomePage:!1,title:"Sending Messenger Messages",description:"Messenger has become one of the most popular channels between businesses and customers. Most of the messenger bots are designed for 1:1 communication.",source:"@site/versioned_docs/version-1.0.5/channel-messenger-sending-messages.md",sourceDirName:".",slug:"/channel-messenger-sending-messages",permalink:"/docs/1.0.5/channel-messenger-sending-messages",editUrl:"https://github.com/Yoctol/bottender/edit/master/docs/versioned_docs/version-1.0.5/channel-messenger-sending-messages.md",tags:[],version:"1.0.5",lastUpdatedBy:"\u5433\u6771\u66c4 Wu, Dung-Ie",lastUpdatedAt:1636542901,formattedLastUpdatedAt:"11/10/2021",frontMatter:{id:"channel-messenger-sending-messages",title:"Sending Messenger Messages",original_id:"channel-messenger-sending-messages"},sidebar:"version-1.0.5/docs",previous:{title:"Handling Messenger Events",permalink:"/docs/1.0.5/channel-messenger-handling-events"},next:{title:"Messenger Profile",permalink:"/docs/1.0.5/channel-messenger-profile"}},c=[{value:"Sending Text Messages",id:"sending-text-messages",children:[],level:2},{value:"Sending Rich Media Messages",id:"sending-rich-media-messages",children:[{value:"Approach 1: Send by URL",id:"approach-1-send-by-url",children:[],level:3},{value:"Approach 2: Attaching Saved Assets",id:"approach-2-attaching-saved-assets",children:[],level:3},{value:"Approach 3: Attaching ReadStreams",id:"approach-3-attaching-readstreams",children:[],level:3},{value:"Approach 4: Attaching Buffers",id:"approach-4-attaching-buffers",children:[],level:3}],level:2},{value:"Sending Template Messages",id:"sending-template-messages",children:[{value:"Generic Template",id:"generic-template",children:[],level:3},{value:"Button Template",id:"button-template",children:[],level:3},{value:"Receipt Template",id:"receipt-template",children:[],level:3},{value:"Media Template",id:"media-template",children:[],level:3}],level:2},{value:"Sending with Quick Reply",id:"sending-with-quick-reply",children:[{value:"Text Quick Reply",id:"text-quick-reply",children:[],level:3},{value:"User Phone Number Quick Reply",id:"user-phone-number-quick-reply",children:[],level:3},{value:"User Email Quick Reply",id:"user-email-quick-reply",children:[],level:3}],level:2},{value:"Sending with Persona",id:"sending-with-persona",children:[],level:2},{value:"Rate Limits",id:"rate-limits",children:[],level:2}],m={toc:c};function u(e){var t=e.components,n=(0,i.Z)(e,o);return(0,s.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"Messenger has become one of the most popular channels between businesses and customers. Most of the messenger bots are designed for 1:1 communication."),(0,s.kt)("p",null,'Although the document is about "sending messages," in most of the cases, Messenger bots send messages after it receives a user event.'),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:")),(0,s.kt)("ul",{parentName:"blockquote"},(0,s.kt)("li",{parentName:"ul"},"If you want to know better about when your bots can send message proactively, please refer to Messenger's guide link about ",(0,s.kt)("a",{parentName:"li",href:"https://developers.facebook.com/docs/messenger-platform/policy/policy-overview#standard_messaging"},"Messenger Platform Policy Overview"),"."),(0,s.kt)("li",{parentName:"ul"},"We have a separate document to introduce user event handling, please refer to ",(0,s.kt)("a",{parentName:"li",href:"/docs/1.0.5/channel-messenger-handling-events"},"Handling Messenger Events"),"."))),(0,s.kt)("p",null,"If you are not familiar with Messenger messages, we would like to recommend a short happy path."),(0,s.kt)("p",null,"To begin with, please try the basis of communication, ",(0,s.kt)("a",{parentName:"p",href:"#sending-text-messages"},(0,s.kt)("inlineCode",{parentName:"a"},"Text Messages")),". Secondly, try ",(0,s.kt)("a",{parentName:"p",href:"#sending-template-messages"},(0,s.kt)("inlineCode",{parentName:"a"},"Generic Template Messages"))," to help you display a collection of items (e.g., recommended restaurants, songs, or books). Finally, - ",(0,s.kt)("a",{parentName:"p",href:"#sending-with-quick-reply"},(0,s.kt)("inlineCode",{parentName:"a"},"Quick Replies")),", which continuously guides your users for the next possible actions."),(0,s.kt)("p",null,"If you have experienced with Messenger messages, don't miss ",(0,s.kt)("a",{parentName:"p",href:"#sending-rich-media-messages"},(0,s.kt)("inlineCode",{parentName:"a"},"Rich Media Messages"))," to show the personality of your bots. ",(0,s.kt)("a",{parentName:"p",href:"#sending-rich-media-messages"},(0,s.kt)("inlineCode",{parentName:"a"},"Rich Media Messages"))," and ",(0,s.kt)("a",{parentName:"p",href:"#media-template"},(0,s.kt)("inlineCode",{parentName:"a"},"Media Template Messages"))," are necessary if you are building a media-driven, storytelling bot. Take a look at ",(0,s.kt)("a",{parentName:"p",href:"#sending-with-persona"},(0,s.kt)("inlineCode",{parentName:"a"},"Persona")),", if you offer bot auto-reply and human agent customer support at the same time. Finally, if you are making a chatbot for campaign purposes, please dive into ",(0,s.kt)("a",{parentName:"p",href:"#rate-limits"},(0,s.kt)("inlineCode",{parentName:"a"},"Rate Limits"))," to ensure your bot is ready for high traffic."),(0,s.kt)("h2",{id:"sending-text-messages"},"Sending Text Messages"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69112041-4e2d2e00-0aba-11ea-8e44-02aaaf804b5d.png",alt:"39993793_311437072745802_2909561891720265728_n"})),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Text message")," is the most frequent and common message types among all chat channels. It also offers a minimal format while carrying out dynamic data, e.g., stock price and weather info."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"async function SendHi(context) {\n  await context.sendText('Hi!');\n}\n")),(0,s.kt)("h2",{id:"sending-rich-media-messages"},"Sending Rich Media Messages"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69852152-7be65400-12be-11ea-87d3-25837d74c91c.gif",alt:"ezgif-1-ef5b05e9923c"})),(0,s.kt)("p",null,"Rich media consist of images, videos, audios, and files."),(0,s.kt)("p",null,"Rich media is useful when your priority is to catch the user's attention, e.g., limited promotion. Plus, it is also handy to create an immersive experience, e.g., telling a story."),(0,s.kt)("p",null,"In the following section, you can see four different approaches while sending ",(0,s.kt)("inlineCode",{parentName:"p"},"Rich Media Messages"),"."),(0,s.kt)("p",null,"If you want to benefit from Facebook's cache, i.e., much faster loader time, then you should jump to section ",(0,s.kt)("a",{parentName:"p",href:"#attaching-saved-assets"},"Attaching Saved Assets"),"."),(0,s.kt)("h3",{id:"approach-1-send-by-url"},"Approach 1: Send by URL"),(0,s.kt)("p",null,"Sending by URL might be the easiest way in terms of implementation. We recommend you to use this approach only for prototyping; the loading speed is probably driving your clients or customers crazy."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendImage('https://example.com/image.jpg');\nawait context.sendVideo('https://example.com/video.mp4');\nawait context.sendAudio('https://example.com/audio.mp3');\nawait context.sendFile('https://example.com/receipt.pdf');\n")),(0,s.kt)("h3",{id:"approach-2-attaching-saved-assets"},"Approach 2: Attaching Saved Assets"),(0,s.kt)("p",null,"If you want to benefit from Facebook's cache, i.e., a much pleasant loading speed, you should try this a bit complicated approach."),(0,s.kt)("p",null,"Firstly, you need to get a page-scoped ",(0,s.kt)("inlineCode",{parentName:"p"},"Attachment Id")," by ",(0,s.kt)("a",{parentName:"p",href:"https://developers.facebook.com/docs/messenger-platform/send-messages/saving-assets#attachment_upload_api"},"Attachment Upload API"),"."),(0,s.kt)("p",null,"Once you get your ",(0,s.kt)("inlineCode",{parentName:"p"},"Attachment Id"),", you can send rich media messages with the following code."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendImage({ attachmentId: '<ATTACHMENT_ID>' });\nawait context.sendVideo({ attachmentId: '<ATTACHMENT_ID>' });\nawait context.sendAudio({ attachmentId: '<ATTACHMENT_ID>' });\nawait context.sendFile({ attachmentId: '<ATTACHMENT_ID>' });\n")),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:")," > ",(0,s.kt)("inlineCode",{parentName:"p"},"Attachment Id")," is page-scoped.")),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"A commercial bot project usually involves a staging Page for development and a production Page for production. In this case, before bot release, you have to re-upload all the attachments and update all the ",(0,s.kt)("inlineCode",{parentName:"p"},"Attachment Id"),".")),(0,s.kt)("h3",{id:"approach-3-attaching-readstreams"},"Approach 3: Attaching ReadStreams"),(0,s.kt)("p",null,"In the following example, you can send rich media by creating a readable stream. The file path is relative to your bot location."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"const fs = require('fs');\n\nawait context.sendImage(fs.createReadStream('image.jpg'));\nawait context.sendVideo(fs.createReadStream('video.mp4'));\nawait context.sendAudio(fs.createReadStream('audio.mp3'));\nawait context.sendFile(fs.createReadStream('receipt.pdf'));\n")),(0,s.kt)("h3",{id:"approach-4-attaching-buffers"},"Approach 4: Attaching Buffers"),(0,s.kt)("p",null,"In the following example, you can send rich media by creating a buffer. The file path is relative to your bot location."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendImage(imageBuffer, { filename: 'image.jpg' });\nawait context.sendVideo(videoBuffer, { filename: 'video.mp4' });\nawait context.sendAudio(audioBuffer, { filename: 'audio.mp3' });\nawait context.sendFile(fileBuffer, { filename: 'receipt.pdf' });\n")),(0,s.kt)("h2",{id:"sending-template-messages"},"Sending Template Messages"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69858895-f79bcd00-12cd-11ea-999d-2f6c97e83f51.png",alt:"66391040_700974230346439_7580226164833124352_n"})),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69858886-f5397300-12cd-11ea-888a-c93ec4ca7288.png",alt:"66362686_447994139365537_8885089546354556928_n"})),(0,s.kt)("p",null,"In short, ",(0,s.kt)("inlineCode",{parentName:"p"},"Template message")," is an interactive gallery composed of image, video, title, subtitle, and buttons."),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Template message")," is the key to offer rich media interaction. It usually used in the scenario of display multiple choices and next actions to the user, e.g., applying coupon, booking a room, making a reservation."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:")),(0,s.kt)("ul",{parentName:"blockquote"},(0,s.kt)("li",{parentName:"ul"},"If you are familiar with LINE and Messenger, you can find the difference Chat UI approach. While LINE creates an HTML-like, super flexible chat UI, ",(0,s.kt)("a",{parentName:"li",href:"/docs/1.0.5/channel-line-flex"},(0,s.kt)("inlineCode",{parentName:"a"},"Flex Messages")),", Messenger tends to focus on common chat UI patterns to offer a consistent user experience."))),(0,s.kt)("h3",{id:"generic-template"},"Generic Template"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69859663-89f0a080-12cf-11ea-82d4-114745d4724d.png",alt:"22880422_1740199342956641_1916832982102966272_n (1)"})),(0,s.kt)("p",null,"In a ",(0,s.kt)("inlineCode",{parentName:"p"},"Generic Template"),", you can create up to 10 items in a row. Each item is composed of a title, subtitle, image, and up to 3 buttons."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:"),"\nPlease refer to Messenger's official guide of ",(0,s.kt)("a",{parentName:"p",href:"https://developers.facebook.com/docs/messenger-platform/send-messages/template/generic"},(0,s.kt)("inlineCode",{parentName:"a"},"Generic Template"))," to find out the latest specification.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendGenericTemplate([\n  {\n    title: \"Welcome to Peter's Hats\",\n    imageUrl: 'https://petersfancybrownhats.com/company_image.png',\n    subtitle: \"We've got the right hat for everyone.\",\n    defaultAction: {\n      type: 'web_url',\n      url: 'https://peterssendreceiveapp.ngrok.io/view?item=103',\n      messengerExtensions: true,\n      webviewHeightRatio: 'tall',\n      fallbackUrl: 'https://peterssendreceiveapp.ngrok.io/',\n    },\n    buttons: [\n      {\n        type: 'postback',\n        title: 'Start Chatting',\n        payload: 'DEVELOPER_DEFINED_PAYLOAD',\n      },\n    ],\n  },\n]);\n")),(0,s.kt)("h3",{id:"button-template"},"Button Template"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69862063-9dead100-12d4-11ea-88ea-f2aef56b59c8.png",alt:"23204276_131607050888932_1057585862134464512_n (1)"})),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Button Template")," is similar to ",(0,s.kt)("inlineCode",{parentName:"p"},"Generic Template"),"; the only difference is the removal of the item image."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:"),"\nPlease refer to Messenger's official guide of ",(0,s.kt)("a",{parentName:"p",href:"https://developers.facebook.com/docs/messenger-platform/send-messages/template/button"},(0,s.kt)("inlineCode",{parentName:"a"},"Button Template"))," to find out the latest specification.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendButtonTemplate('What do you want to do next?', [\n  {\n    type: 'web_url',\n    url: 'https://petersapparel.parseapp.com',\n    title: 'Show Website',\n  },\n  {\n    type: 'postback',\n    title: 'Start Chatting',\n    payload: 'USER_DEFINED_PAYLOAD',\n  },\n]);\n")),(0,s.kt)("h3",{id:"receipt-template"},"Receipt Template"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69862400-4862f400-12d5-11ea-8786-2e7fa03e8408.png",alt:"23208289_889588377870772_7170760265053503488_n"})),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Receipt Template")," is a template designed for order confirmation."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:"),"\nPlease refer to Messenger's official guide of ",(0,s.kt)("a",{parentName:"p",href:"https://developers.facebook.com/docs/messenger-platform/send-messages/template/receipt"},(0,s.kt)("inlineCode",{parentName:"a"},"Receipt Template"))," to find out the latest specification.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendReceiptTemplate({\n  recipientName: 'Stephane Crozatier',\n  orderNumber: '12345678902',\n  currency: 'USD',\n  paymentMethod: 'Visa 2345',\n  orderUrl: 'http://petersapparel.parseapp.com/order?order_id=123456',\n  timestamp: '1428444852',\n  elements: [\n    {\n      title: 'Classic White T-Shirt',\n      subtitle: '100% Soft and Luxurious Cotton',\n      quantity: 2,\n      price: 50,\n      currency: 'USD',\n      imageUrl: 'http://petersapparel.parseapp.com/img/whiteshirt.png',\n    },\n    {\n      title: 'Classic Gray T-Shirt',\n      subtitle: '100% Soft and Luxurious Cotton',\n      quantity: 1,\n      price: 25,\n      currency: 'USD',\n      imageUrl: 'http://petersapparel.parseapp.com/img/grayshirt.png',\n    },\n  ],\n  address: {\n    street1: '1 Hacker Way',\n    street2: '',\n    city: 'Menlo Park',\n    postalCode: '94025',\n    state: 'CA',\n    country: 'US',\n  },\n  summary: {\n    subtotal: 75.0,\n    shippingCost: 4.95,\n    totalTax: 6.19,\n    totalCost: 56.14,\n  },\n  adjustments: [\n    {\n      name: 'New Customer Discount',\n      amount: 20,\n    },\n    {\n      name: '$10 Off Coupon',\n      amount: 10,\n    },\n  ],\n});\n")),(0,s.kt)("h3",{id:"media-template"},"Media Template"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69862411-4c8f1180-12d5-11ea-84a7-1a07b10e15c4.png",alt:"23666967_188506161716866_2869776016224550912_n"}),"\n",(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69862818-4483a180-12d6-11ea-8575-96f976551963.png",alt:"23065701_1942345712696886_5686788878908784640_n"})),(0,s.kt)("p",null,"You can find the simplicity and elegance of ",(0,s.kt)("inlineCode",{parentName:"p"},"Media Template"),'. Try it if you agree with "A picture is worth a thousand words." The difference between it and ',(0,s.kt)("inlineCode",{parentName:"p"},"Generic Template")," is the removal of title and subtitle."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:"),"\nPlease refer to Messenger's official guide of ",(0,s.kt)("a",{parentName:"p",href:"https://developers.facebook.com/docs/messenger-platform/send-messages/template/media"},(0,s.kt)("inlineCode",{parentName:"a"},"Media Template"))," to find out the latest specification.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendMediaTemplate([\n  {\n    mediaType: 'image',\n    attachmentId: '1854626884821032',\n    buttons: [\n      {\n        type: 'web_url',\n        url: 'https://en.wikipedia.org/wiki/Rickrolling',\n        title: 'View Website',\n      },\n    ],\n  },\n]);\n")),(0,s.kt)("h2",{id:"sending-with-quick-reply"},"Sending with Quick Reply"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69863622-42224700-12d8-11ea-9202-cd55011a62d0.png",alt:"64375249_668002483666648_541982039046356992_n (1)"})),(0,s.kt)("p",null,"We would recommend you to treat ",(0,s.kt)("inlineCode",{parentName:"p"},"Quick Reply")," as an alternative to user text input."),(0,s.kt)("p",null,"A ",(0,s.kt)("inlineCode",{parentName:"p"},"Quick Reply")," consists of up to 13 ",(0,s.kt)("inlineCode",{parentName:"p"},"Quick Reply Buttons"),". When the user taps a ",(0,s.kt)("inlineCode",{parentName:"p"},"Quick Reply Button"),", the ",(0,s.kt)("inlineCode",{parentName:"p"},"Quick Reply")," dismissed. Then, the title of the tapped button is posted to the conversation as a message. Meanwhile, a messages event sends to your webhook that contains the button title and an optional payload."),(0,s.kt)("p",null,"In the following sections, you can see three different types of ",(0,s.kt)("inlineCode",{parentName:"p"},"Quick Reply"),"."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:")),(0,s.kt)("ul",{parentName:"blockquote"},(0,s.kt)("li",{parentName:"ul"},"When we met ",(0,s.kt)("inlineCode",{parentName:"li"},"Quick Reply")," first time, we were confused about the best practice of using ",(0,s.kt)("inlineCode",{parentName:"li"},"Quick Reply")," or ",(0,s.kt)("inlineCode",{parentName:"li"},"Button"),". Finally, we found out ",(0,s.kt)("inlineCode",{parentName:"li"},"Quick Reply")," is the best solution to guide the user to keep interacting with the bot, while a ",(0,s.kt)("inlineCode",{parentName:"li"},"URL Button")," brings user outside bot.\nWhat's more, the ",(0,s.kt)("inlineCode",{parentName:"li"},"Quick Reply")," disappears when one of ",(0,s.kt)("inlineCode",{parentName:"li"},"Quick Reply Buttons")," is tapped, which keeps ",(0,s.kt)("inlineCode",{parentName:"li"},"Quick Reply")," only live under the present context, while a ",(0,s.kt)("inlineCode",{parentName:"li"},"Button")," can be triggered even it is in the chat history."),(0,s.kt)("li",{parentName:"ul"},"Please refer to Messenger's official guide of ",(0,s.kt)("a",{parentName:"li",href:"https://developers.facebook.com/docs/messenger-platform/send-messages/quick-replies"},(0,s.kt)("inlineCode",{parentName:"a"},"Quick Replies"))," to find out the latest specification."))),(0,s.kt)("h3",{id:"text-quick-reply"},"Text Quick Reply"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69863608-3c2c6600-12d8-11ea-97c0-e82992175a24.png",alt:"27690048_220332918537125_7991605536967622656_n"})),(0,s.kt)("p",null,"You can send up to 13 ",(0,s.kt)("inlineCode",{parentName:"p"},"Text Quick Reply Buttons")," in a ",(0,s.kt)("inlineCode",{parentName:"p"},"Quick Reply"),". Each ",(0,s.kt)("inlineCode",{parentName:"p"},"Text Quick Reply")," can add one optional icon next to the button title."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendText('Hi!', {\n  quickReplies: [\n    {\n      contentType: 'text',\n      title: '<BUTTON_TEXT>',\n      payload: '<DEVELOPER_DEFINED_PAYLOAD>',\n    },\n  ],\n});\n")),(0,s.kt)("h3",{id:"user-phone-number-quick-reply"},"User Phone Number Quick Reply"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/662387/69863631-48182800-12d8-11ea-8d6c-f8140829163d.png",alt:"23417458_1117232598379764_7436715136921894912_n"})),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"User Phone Number Quick Reply")," can be treated as an agree button to collect the user's phone number."),(0,s.kt)("p",null,"Messenger automatically pre-fill the displayed quick reply with the phone number from the user's profile information. Since many CRM (Customer Relationship Management) use the phone number as a unique id, it is handy for future user mapping."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:"),"\nIf the user's profile does not have a phone number, the quick reply doesn't show up. Also, the bot only receives the phone number until the user clicks the quick reply.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendText('Hi!', {\n  quickReplies: [\n    {\n      contentType: 'user_phone_number',\n    },\n  ],\n});\n")),(0,s.kt)("h3",{id:"user-email-quick-reply"},"User Email Quick Reply"),(0,s.kt)("img",{width:"382",alt:"27807597_203144990422079_3327502058327638016_n",src:"https://user-images.githubusercontent.com/662387/69863616-3f275680-12d8-11ea-82b0-d4033f67f03c.png"}),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"User Email Quick Reply")," can be treated as an agree button to collect the user's Email."),(0,s.kt)("p",null,"Messenger automatically pre-fill the displayed quick reply with the Email from the user's profile information. Since many CRM (Customer Relationship Management) use the Email as a unique id, it is handy for future user mapping."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:"),"\nIf the user's profile does not have an Email, the quick reply doesn't show up. Also, the bot only receives the Email until the user clicks the quick reply.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendText('Hi!', {\n  quickReplies: [\n    {\n      contentType: 'user_email',\n    },\n  ],\n});\n")),(0,s.kt)("h2",{id:"sending-with-persona"},"Sending with Persona"),(0,s.kt)("p",null,"To give the customer a clear understanding of whether a human agent or a bot representing the Business Page, the ",(0,s.kt)("inlineCode",{parentName:"p"},"Persona")," API allows a business to introduce a virtual persona into the thread. Please refer to our separate document about ",(0,s.kt)("inlineCode",{parentName:"p"},"Persona"),"."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"await context.sendText('Hi!', {\n  personaId: '<PERSONA_ID>',\n});\n")),(0,s.kt)("h2",{id:"rate-limits"},"Rate Limits"),(0,s.kt)("p",null,"If you are making a bot with sudden high traffic, e.g., a campaign bot for Black Friday, you should deal with ",(0,s.kt)("inlineCode",{parentName:"p"},"Rate Limits")," before you receive ",(0,s.kt)("a",{parentName:"p",href:"https://developers.facebook.com/docs/messenger-platform/reference/send-api/error-codes"},"error code 613"),"."),(0,s.kt)("p",null,"Page Rate limits are in place to prevent malicious behavior and poor user experiences. For Pages with large audiences, Messenger recommends a send rate of 250 requests per second."),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Rate Limits")," is various from the size of your Page audience."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-sh"},"Calls within 24 hours = 200 * Total Messenger Audience\n")),(0,s.kt)("p",null,"To prevent from hit ",(0,s.kt)("inlineCode",{parentName:"p"},"Rate Limits"),", Messenger also advises us to architect our system to distribute any sudden high amounts of load over time."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},(0,s.kt)("strong",{parentName:"p"},"Note:"),"\nRefer to Messenger's official doc, ",(0,s.kt)("a",{parentName:"p",href:"https://developers.facebook.com/docs/messenger-platform/send-messages#limits"},"Rate Limiting")," for the latest Messenger policy.")))}u.isMDXComponent=!0}}]);