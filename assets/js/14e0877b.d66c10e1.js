"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[77034],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),l=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(i.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(n),m=a,h=u["".concat(i,".").concat(m)]||u[m]||d[m]||o;return n?r.createElement(h,p(p({ref:t},c),{},{components:n})):r.createElement(h,p({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,p=new Array(o);p[0]=u;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,p[1]=s;for(var l=2;l<o;l++)p[l]=n[l];return r.createElement.apply(null,p)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},73410:(e,t,n)=>{n.r(t),n.d(t,{frontMatter:()=>s,contentTitle:()=>i,metadata:()=>l,assets:()=>c,toc:()=>d,default:()=>m});var r=n(87462),a=n(63366),o=(n(67294),n(3905)),p=["components"],s={title:"Bottender 1.3: WhatsApp Support, TypeScript Improvement",author:"C. T. Lin",authorURL:"https://twitter.com/chentsulin",authorTitle:"Co-Creator of Bottender",authorTwitter:"chentsulin",authorImageURL:"https://avatars1.githubusercontent.com/u/3382565?s=460&v=4"},i=void 0,l={permalink:"/blog/2020/03/06/bottender-1_3",source:"@site/blog/2020-03-06-bottender-1_3.md",title:"Bottender 1.3: WhatsApp Support, TypeScript Improvement",description:"We are excited to introduce Bottender 1.3 today, featuring:",date:"2020-03-06T00:00:00.000Z",formattedDate:"March 6, 2020",tags:[],readingTime:3,truncated:!0,authors:[{name:"C. T. Lin",title:"Co-Creator of Bottender",url:"https://twitter.com/chentsulin",imageURL:"https://avatars1.githubusercontent.com/u/3382565?s=460&v=4"}],prevItem:{title:"Notice of LINE domain name change for certain endpoints",permalink:"/blog/2020/04/08/line-domain-name-change"},nextItem:{title:"Bottender 1.2: Serverless, NLU Integration, and More",permalink:"/blog/2020/01/22/bottender-1_2"}},c={authorsImageUrls:[void 0]},d=[{value:"WhatsApp Support",id:"whatsapp-support",children:[],level:2},{value:"Slack Request Signing",id:"slack-request-signing",children:[],level:2},{value:"Slack Slash Command",id:"slack-slash-command",children:[{value:"TypeScript Support in Create Bottender App",id:"typescript-support-in-create-bottender-app",children:[],level:3},{value:"More Exported TypeScript Types",id:"more-exported-typescript-types",children:[],level:3}],level:2}],u={toc:d};function m(e){var t=e.components,n=(0,a.Z)(e,p);return(0,o.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/3382565/76055870-d410ae80-5faf-11ea-89bf-b3f09a773285.png",alt:null})),(0,o.kt)("p",null,"We are excited to introduce Bottender 1.3 today, featuring:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/blog/2020/03/06/bottender-1_3#whatsapp-support"},"WhatsApp Support"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/blog/2020/03/06/bottender-1_3#slack-request-signing"},"Slack Request Signing"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/blog/2020/03/06/bottender-1_3#slack-slash-command"},"Slack Slash Command"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/blog/2020/03/06/bottender-1_3#typescript-support-in-create-bottender-app"},"TypeScript Support in Create Bottender App"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"/blog/2020/03/06/bottender-1_3#more-exported-typescript-types"},"More Exported TypeScript Types")))),(0,o.kt)("h2",{id:"whatsapp-support"},"WhatsApp Support"),(0,o.kt)("p",null,"Since we released Bottender in 2017, WhatsApp support has been a highly requested feature because of its popularity."),(0,o.kt)("p",null,"As a result, we managed to implement the support with ",(0,o.kt)("a",{parentName:"p",href:"https://www.twilio.com/whatsapp"},"Twilio API for WhatsApp")," in this release. Twilio API for WhatsApp is one of the most popular ways to send and receive messages programmatically in WhatsApp."),(0,o.kt)("p",null,"In Bottender v1.3, you may enable ",(0,o.kt)("inlineCode",{parentName:"p"},"whatsapp")," webhook in your ",(0,o.kt)("inlineCode",{parentName:"p"},"bottender.config.js")," file to start listening to the WhatsApp requests:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  channels: {\n    whatsapp: {\n      enabled: true,\n      path: '/webhooks/whatsapp',\n      accountSid: process.env.WHATSAPP_ACCOUNT_SID,\n      authToken: process.env.WHATSAPP_AUTH_TOKEN,\n      phoneNumber: process.env.WHATSAPP_PHONE_NUMBER,\n    },\n  },\n};\n")),(0,o.kt)("p",null,"Moreover, Bottender provides the WhatsApp routes for you to define WhatsApp specific routing:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { router, whatsapp } = require('bottender/router');\n\nfunction App() {\n  return router([\n    whatsapp.message(HandleMessage),\n    whatsapp.media(HandleMedia),\n    whatsapp.received(HandleReceived),\n    whatsapp.sent(HandleSent),\n    whatsapp.delivered(HandleDelivered),\n    whatsapp.read(HandleRead),\n    whatsapp(HandleWhatsapp),\n  ]);\n}\n")),(0,o.kt)("h2",{id:"slack-request-signing"},"Slack Request Signing"),(0,o.kt)("p",null,"We now support request signing for verification instead of tokens. According to ",(0,o.kt)("a",{parentName:"p",href:"https://api.slack.com/docs/verifying-requests-from-slack#verification_token_deprecation"},"Slack's announcement"),", verification by the token is deprecated now. We highly recommend our users to upgrade if you're using this feature."),(0,o.kt)("p",null,"To upgrade, get your Slack app's signing secret from Slack console and paste it to your ",(0,o.kt)("inlineCode",{parentName:"p"},".env")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"bottender.config.js")," accordingly. See our ",(0,o.kt)("a",{parentName:"p",href:"https://bottender.js.org/docs/channel-slack-setup"},"doc")," for detailed instruction."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"# .env\n\nSLACK_ACCESS_TOKEN=__YOUR_ACCESS_TOKEN_HERE__\nSLACK_SIGNING_SECRET=__YOUR_SECRET_HERE__\n# SLACK_VERIFICATION_TOKEN= # deprecated, use SLACK_SIGNING_SECRET\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// bottender.config.js\n\nmodule.exports = {\n  channels: {\n    slack: {\n      enabled: true,\n      path: '/webhooks/slack',\n      accessToken: process.env.SLACK_ACCESS_TOKEN,\n      signingSecret: process.env.SLACK_SIGNING_SECRET,\n      // verificationToken: process.env.SLACK_VERIFICATION_TOKEN, // deprecated, use signingSecret\n    },\n  },\n};\n")),(0,o.kt)("h2",{id:"slack-slash-command"},"Slack Slash Command"),(0,o.kt)("p",null,"Plus, we add support for Slack Slash Command. It can handle commands like ",(0,o.kt)("inlineCode",{parentName:"p"},"/todo ask @crushermd to bake a birthday cake for @worf in #d-social")," and access arguments in Bottender context:"),(0,o.kt)("p",null,"To determine whether the event is a slash command event, you may check the boolean value -\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"context.event.isCommand"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"async function App(context) {\n  if (context.event.isCommand) {\n    // handling the slash command event\n  }\n}\n")),(0,o.kt)("p",null,"You can get the command from\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"context.event.command"),"\xa0and its arguments from\xa0",(0,o.kt)("inlineCode",{parentName:"p"},"context.event.text"),"\xa0and use them in the reply:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"async function App(context) {\n  if (context.event.isCommand) {\n    await context.sendText(\n      `I received slash command '${context.event.command}' with arguments: '${context.event.text}'`\n    );\n  }\n}\n")),(0,o.kt)("p",null,"You also need to add commands in Slack's console to enable this feature. See our ",(0,o.kt)("a",{parentName:"p",href:"https://bottender.js.org/docs/channel-slack-slash-comman"},"doc")," for detailed setup in Slack's console."),(0,o.kt)("h3",{id:"typescript-support-in-create-bottender-app"},"TypeScript Support in Create Bottender App"),(0,o.kt)("p",null,"In Bottender v1.3, Create Bottender App makes configuring TypeScript very simple. In fact, almost everything is configured for you out of the box. To create a TypeScript application, the only thing you need to do is to add ",(0,o.kt)("inlineCode",{parentName:"p"},"--typescript")," to your command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"npx create-bottender-app my-app --typescript\n")),(0,o.kt)("p",null,"Besides, you could still use the ",(0,o.kt)("inlineCode",{parentName:"p"},"dev")," command to develop your TypeScript application:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"bottender dev\n")),(0,o.kt)("p",null,"If ",(0,o.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," present, it will watch and compile your TypeScript files for you."),(0,o.kt)("h3",{id:"more-exported-typescript-types"},"More Exported TypeScript Types"),(0,o.kt)("p",null,"In previous releases, most of the types we defined didn't get exported to the Bottender users. It makes our TypeScript users sometimes have to redefine the same types in their codebase."),(0,o.kt)("p",null,"In Bottender v1.3, you may import defined types to type hint your TypeScript application:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import {\n  MessengerTypes,\n  WhatsappTypes,\n  LineTypes,\n  TelegramTypes,\n  SlackTypes,\n  ViberTypes,\n} from 'bottender';\n")),(0,o.kt)("p",null,"However, there are still some types that need to be exported or polished. We will keep an eye on it and try our best to investigate more TypeScript use cases."),(0,o.kt)("p",null,"If you have some problems with using TypeScript in Bottender, feel free to ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Yoctol/bottender/issues/new/choose"},"open an issue")," in Bottender repo. Let's improve it together!"))}m.isMDXComponent=!0}}]);