<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Natural Language Understanding · Bottender</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Leverage NLU Technologies"/><meta name="docsearch:version" content="1.0.5"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Natural Language Understanding · Bottender"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bottender.js.org/"/><meta property="og:description" content="## Leverage NLU Technologies"/><meta property="og:image" content="https://bottender.js.org/img/og-image.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://bottender.js.org/img/og-image.png"/><link rel="shortcut icon" href="/img/favicon-192x192.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><link rel="alternate" type="application/atom+xml" href="https://bottender.js.org/blog/atom.xml" title="Bottender Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://bottender.js.org/blog/feed.xml" title="Bottender Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-70309045-11', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:700|Roboto&amp;display=swap"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-blocks-buttons.js"></script><script type="text/javascript" src="/js/sw.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/bottender.svg" alt="Bottender"/><h2 class="headerTitleWithLogo">Bottender</h2></a><a href="/versions"><h3>1.0.5</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/1.0.5/getting-started" target="_self">Docs</a></li><li class=""><a href="/docs/1.0.5/api-context" target="_self">API</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class=""><a href="/users" target="_self">Users</a></li><li class=""><a href="https://github.com/Yoctol/bottender/tree/master/examples" target="_self">Examples</a></li><li class=""><a href="https://github.com/yoctol/bottender" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Advanced Guides</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/1.0.5/getting-started">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/migrating-v1">Migrating from v0.x to v1.x</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">The Basics</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/1.0.5/the-basics-console-mode">Console Mode</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/the-basics-actions">Resolving Actions</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/the-basics-routing">Routing</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/the-basics-chain">Chain of Responsibility</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/the-basics-session">Session</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/the-basics-errors">Error Handling</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Advanced Guides</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/docs/1.0.5/advanced-guides-nlu">Natural Language Understanding</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/advanced-guides-multi-channel">Multi-Messaging Channel Support</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides (Messenger)</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-messenger-setup">Setup Messenger</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-messenger-handling-events">Handling Messenger Events</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-messenger-sending-messages">Sending Messenger Messages</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-messenger-profile">Messenger Profile</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-messenger-persona">Using Persona</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides (LINE)</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-line-setup">Setup LINE</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-line-handling-events">Handling LINE Events</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-line-sending-messages">Sending LINE Messages</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-line-flex">Sending Flex Message</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-line-rich-menu">Rich Menu</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-line-errors">Error Handling in LINE</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-line-migrating-from-sdk">Migrating from LINE SDK for Node.js</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides (Slack)</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-slack-setup">Setup Slack</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-slack-handling-events">Handling Slack Events</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides (Telegram)</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-telegram-setup">Setup Telegram</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-telegram-handling-events">Handling Telegram Events</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-telegram-sending-messages">Sending Telegram Messages</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Guides (Viber)</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-viber-setup">Setup Viber</a></li><li class="navListItem"><a class="navItem" href="/docs/1.0.5/channel-viber-handling-events">Handling Viber Events</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/Yoctol/bottender/edit/master/docs/advanced-guides-nlu.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Natural Language Understanding</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="leverage-nlu-technologies"></a><a href="#leverage-nlu-technologies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Leverage NLU Technologies</h2>
<p>If you want to have more general intent recognition, you can leverage modern NLU (Natural Language Understanding) technologies. They can help you recognize the intent of user input sentences. There are several online services you can choose from, for example:</p>
<ul>
<li><a href="/docs/1.0.5/advanced-guides-nlu#building-with-dialogflow">DialogFlow</a></li>
<li><a href="/docs/1.0.5/advanced-guides-nlu#building-with-qna-maker">QnA Maker</a></li>
<li><a href="/docs/1.0.5/advanced-guides-nlu#building-with-luis">LUIS</a></li>
<li><a href="/docs/1.0.5/advanced-guides-nlu#building-with-rasa-nlu">Rasa</a></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="building-with-dialogflow"></a><a href="#building-with-dialogflow" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building with DialogFlow</h2>
<p>To build a bot integrated with <a href="https://dialogflow.com/">DialogFlow</a>, you have to setup Dialogflow following the <a href="https://cloud.google.com/dialogflow/docs/quick/setup">Official Setup Guide</a> and fill the two values: <code>GOOGLE_APPLICATION_CREDENTIALS</code> (the file path of the JSON file that contains your service account key) and <code>GOOGLE_APPLICATION_PROJECT_ID</code> (the GCP project ID) into the <code>.env</code> file.</p>
<pre><code class="hljs"><span class="hljs-comment"># .env</span>
<span class="hljs-attr">GOOGLE_APPLICATION_CREDENTIALS</span>=
<span class="hljs-attr">GOOGLE_APPLICATION_PROJECT_ID</span>=
</code></pre>
<p>Next, you can build an agent following the <a href="https://cloud.google.com/dialogflow/docs/quick/build-agent">official document</a>. In this example, we build an agent and create a simple intent with display name <code>greeting</code>. You can set your own training phrases on the Dialogflow console for this intent.</p>
<p>After you finish the settings of the agent, you can then call Dialogflow's API to detect the intention of the message the bot receives. We use <a href="https://github.com/googleapis/nodejs-dialogflow">Dialogflow Node SDK</a> to integrate our bot with Dialogflow.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> dialogflow = <span class="hljs-built_in">require</span>(<span class="hljs-string">'dialogflow'</span>);

<span class="hljs-keyword">const</span> PROJECT_ID = process.env.GOOGLE_APPLICATION_PROJECT_ID;

<span class="hljs-keyword">const</span> sessionClient = <span class="hljs-keyword">new</span> dialogflow.SessionsClient();

<span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params">context</span>) </span>{
  <span class="hljs-keyword">if</span> (context.event.isText) {
    <span class="hljs-keyword">const</span> sessionPath = sessionClient.sessionPath(
      PROJECT_ID,
      context.session.id
    );

    <span class="hljs-keyword">const</span> request = {
      <span class="hljs-attr">session</span>: sessionPath,
      <span class="hljs-attr">queryInput</span>: {
        <span class="hljs-attr">text</span>: {
          <span class="hljs-attr">text</span>: context.event.text,
          <span class="hljs-attr">languageCode</span>: <span class="hljs-string">'en'</span>,
        },
      },
      <span class="hljs-attr">queryParams</span>: {
        <span class="hljs-attr">timeZone</span>: <span class="hljs-string">''</span>,
      },
    };

    <span class="hljs-keyword">const</span> responses = <span class="hljs-keyword">await</span> sessionClient.detectIntent(request);
    <span class="hljs-keyword">const</span> { intent } = responses[<span class="hljs-number">0</span>].queryResult;

    <span class="hljs-keyword">if</span> (intent.displayName === <span class="hljs-string">'greeting'</span>) {
      <span class="hljs-keyword">await</span> context.sendText(<span class="hljs-string">'Hello!'</span>);
    }
  }
};
</code></pre>
<p>You can check out the full example <a href="https://github.com/Yoctol/bottender/tree/master/examples/with-dialogflow">Here</a>.</p>
<p>For more information about how to use Dialogflow with Node.js, you can check <a href="https://googleapis.dev/nodejs/dialogflow/latest/index.html">Dialogflow: Node.js Client Document</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="building-with-qna-maker"></a><a href="#building-with-qna-maker" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building with QnA Maker</h2>
<p>To build a bot integrated with <a href="https://www.qnamaker.ai/">QnA Maker</a>, you have to create the QnA Maker knowledge base and publish it following the <a href="https://docs.microsoft.com/en-us/azure/cognitive-services/qnamaker/quickstarts/create-publish-knowledge-base">Official Guide</a>.</p>
<p>After you publish your knowledge base, you will get <code>RESOURCE_NAME</code>, <code>KNOWLEDGE_BASE_ID</code>, and <code>ENDPOINT_KEY</code> (See <a href="https://docs.microsoft.com/en-us/azure/cognitive-services/qnamaker/quickstarts/get-answer-from-knowledge-base-using-url-tool?pivots=url-test-tool-postman">Here</a> for detailed guide). Make sure you copy them into the <code>.env</code> file.</p>
<pre><code class="hljs"><span class="hljs-comment"># .env</span>
<span class="hljs-attr">RESOURCE_NAME</span>=
<span class="hljs-attr">KNOWLEDGE_BASE_ID</span>=
<span class="hljs-attr">ENDPOINT_KEY</span>=
</code></pre>
<p>Next, we can get the answer by calling the API endpoint. In the example, we use <code>axios</code> as our HTTP client. For other Node HTTP clients like <code>request-promise</code>, you can see this <a href="https://docs.microsoft.com/en-us/azure/cognitive-services/qnamaker/quickstarts/get-answer-from-knowledge-base-nodejs">document</a>. The returned response will contain an array with possible QA pairs and corresponding scores. You can define your own score threshold in the code.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>);

<span class="hljs-keyword">const</span> { RESOURCE_NAME, KNOWLEDGE_BASE_ID, ENDPOINT_KEY } = process.env;

<span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params">context</span>) </span>{
  <span class="hljs-keyword">if</span> (context.event.isText) {
    <span class="hljs-keyword">const</span> { data } = <span class="hljs-keyword">await</span> axios.post(
      <span class="hljs-string">`https://<span class="hljs-subst">${RESOURCE_NAME}</span>.azurewebsites.net/qnamaker/knowledgebases/<span class="hljs-subst">${KNOWLEDGE_BASE_ID}</span>/generateAnswer`</span>,
      { <span class="hljs-attr">question</span>: context.event.text },
      {
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-attr">Authorization</span>: <span class="hljs-string">`EndpointKey <span class="hljs-subst">${ENDPOINT_KEY}</span>`</span>,
        },
      }
    );

    <span class="hljs-keyword">const</span> topAnswer = data.answers[<span class="hljs-number">0</span>];

    <span class="hljs-comment">// You can define your own score threshold here.</span>
    <span class="hljs-keyword">if</span> (topAnswer.score &gt; <span class="hljs-number">70</span>) {
      <span class="hljs-keyword">await</span> context.sendText(topAnswer.answer);
    }
  }
};
</code></pre>
<p>You can check out the full example <a href="https://github.com/Yoctol/bottender/tree/master/examples/with-qna-maker">Here</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="building-with-luis"></a><a href="#building-with-luis" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building with LUIS</h2>
<p>To build a bot integrated with <a href="https://luis.ai/">LUIS (Language Understanding Intelligent Service)</a>, you have to create a new app in the LUIS portal following the <a href="https://docs.microsoft.com/en-us/azure/cognitive-services/LUIS/get-started-portal-build-app">Official Setup Guide</a> and fill the three values: <code>LUIS_APP_ID</code>, <code>LUIS_APP_KEY</code>, and <code>LUIS_APP_ENDPOINT</code> into the <code>.env</code> file.</p>
<pre><code class="hljs"><span class="hljs-comment"># .env</span>
<span class="hljs-attr">LUIS_APP_ID</span>=
<span class="hljs-attr">LUIS_APP_KEY</span>=
<span class="hljs-attr">LUIS_APP_ENDPOINT</span>=
</code></pre>
<p>Next, you can add a simple intent. In this example, we create a simple intent with the intent name <code>greeting</code>. You can set your own training phrases on the LUIS console for this intent. And then you have to train the model and publish it.</p>
<p>After publishing successfully, you can call LUIS's API to detect the intention of the message the bot receives. In this example, we use <code>axios</code> as our HTTP client to call the API.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>);

<span class="hljs-keyword">const</span> { LUIS_APP_KEY, LUIS_APP_ENDPOINT, LUIS_APP_ID } = process.env;

<span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params">context</span>) </span>{
  <span class="hljs-keyword">if</span> (context.event.isText) {
    <span class="hljs-keyword">const</span> queryParams = {
      <span class="hljs-attr">verbose</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">q</span>: context.event.text,
      <span class="hljs-string">'subscription-key'</span>: LUIS_APP_KEY,
    };

    <span class="hljs-keyword">const</span> { data } = <span class="hljs-keyword">await</span> axios.get(
      <span class="hljs-string">`<span class="hljs-subst">${LUIS_APP_ENDPOINT}</span>luis/v2.0/apps/<span class="hljs-subst">${LUIS_APP_ID}</span>`</span>,
      {
        <span class="hljs-attr">params</span>: queryParams,
      }
    );

    <span class="hljs-keyword">const</span> { topScoringIntent } = data;

    <span class="hljs-keyword">if</span> (topScoringIntent.intent === <span class="hljs-string">'greeting'</span>) {
      <span class="hljs-keyword">await</span> context.sendText(<span class="hljs-string">'Hello!'</span>);
    }
  }
};
</code></pre>
<p>You can check out the full example <a href="https://github.com/Yoctol/bottender/tree/master/examples/with-luis.ai">Here</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="building-with-rasa-nlu"></a><a href="#building-with-rasa-nlu" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building with Rasa NLU</h2>
<p>To build a bot integrated with <a href="https://rasa.com/docs/rasa/nlu/about/">Rasa NLU</a>, you have to install Rasa first following the <a href="https://rasa.com/docs/rasa/user-guide/installation/">Official Installation Guide</a>. Next, you can train your NLU model by running:</p>
<pre><code class="hljs css language-sh">rasa train nlu
</code></pre>
<p>This command will look for the training data files in the data/ directory and saves the model in the models/ directory. For information about how to generate training data, you can see <a href="https://rasa.com/docs/rasa/nlu/training-data-format/">here</a>.</p>
<p>After you get your NLU model ready, you can run the following command:</p>
<pre><code class="hljs css language-sh">rasa run --<span class="hljs-built_in">enable</span>-api -m models/nlu-your-model-id.tar.gz
</code></pre>
<p>This will start a server with your NLU model locally on port 5005. Next, you can request predictions from your model by calling the <code>/model/parse</code> endpoint. You can see <a href="https://rasa.com/docs/rasa/api/http-api/#operation/parseModelMessage">here</a> for the document of this API.</p>
<p>In this example, we use <code>axios</code> as our HTTP client. The returned response will contain an intent with its corresponding confidence. You can define your own confidence threshold in the code.</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>);

<span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params">context</span>) </span>{
  <span class="hljs-keyword">if</span> (context.event.isText) {
    <span class="hljs-keyword">const</span> { data } = <span class="hljs-keyword">await</span> axios.post(<span class="hljs-string">`http://localhost:5005/model/parse`</span>, {
      <span class="hljs-attr">text</span>: context.event.text,
    });

    <span class="hljs-keyword">const</span> { intent } = data;

    <span class="hljs-comment">// You can define your own confidence threshold here.</span>
    <span class="hljs-keyword">if</span> (intent.confidence &gt; <span class="hljs-number">0.7</span>) {
      <span class="hljs-keyword">if</span> (intent.name === <span class="hljs-string">'greeting'</span>) {
        <span class="hljs-keyword">await</span> context.sendText(<span class="hljs-string">'Hello!'</span>);
      }
    }
  }
};
</code></pre>
<p>You can check out the full example <a href="https://github.com/Yoctol/bottender/tree/master/examples/with-rasa">Here</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/1.0.5/the-basics-errors"><span class="arrow-prev">← </span><span>Error Handling</span></a><a class="docs-next button" href="/docs/1.0.5/advanced-guides-multi-channel"><span>Multi-Channel Support</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#leverage-nlu-technologies">Leverage NLU Technologies</a></li><li><a href="#building-with-dialogflow">Building with DialogFlow</a></li><li><a href="#building-with-qna-maker">Building with QnA Maker</a></li><li><a href="#building-with-luis">Building with LUIS</a></li><li><a href="#building-with-rasa-nlu">Building with Rasa NLU</a></li></ul></nav></div><footer class="nav-footer" id="footer"><div class="footer-layout"><div><div style="margin-bottom:16px"><a href="https://yoctol.ai" target="_blank" rel="noopener noreferrer"><img width="104px" src="/img/element_YOCTOL.AI_horizontal_S.svg" alt="YOCTOL.AI Logo"/></a></div><div class="desktop"><p class="text">© 2019 - PRESENT YOCTOL.AI ALL RIGHTS RESERVED.</p><a class="text" href="https://yoctol.ai/terms-of-use" target="_blank" rel="noopener noreferrer">Terms of Use</a><a class="text" href="https://yoctol.ai/privacy-policy" target="_blank" rel="noopener noreferrer" style="margin-left:16px">Privacy Policy</a></div></div><div class="footer-contacts"><h4 class="title">Contact Us</h4><p class="text">YOCTOL.AI</p><p class="text">service@yoctol.com</p></div><div class="footer-medias"><h4 class="title">Social Media</h4><div class="icons"><a href="https://twitter.com/yoctol" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#FFF" fill-rule="nonzero" d="M1.5 0h21A1.5 1.5 0 0 1 24 1.5v21a1.5 1.5 0 0 1-1.5 1.5h-21A1.5 1.5 0 0 1 0 22.5v-21A1.5 1.5 0 0 1 1.5 0zm7.532 18c6.037 0 9.34-4.617 9.34-8.621 0-.131 0-.262-.01-.392A6.419 6.419 0 0 0 20 7.42c-.6.245-1.235.406-1.885.477a3.097 3.097 0 0 0 1.443-1.676 6.92 6.92 0 0 1-2.085.735c-1.017-.999-2.634-1.243-3.944-.596-1.31.647-1.986 2.024-1.65 3.36-2.64-.123-5.099-1.273-6.765-3.166-.872 1.384-.427 3.155 1.016 4.045a3.468 3.468 0 0 1-1.49-.38v.039c0 1.442 1.102 2.684 2.634 2.97-.484.122-.99.14-1.483.052.43 1.234 1.663 2.08 3.067 2.104a6.945 6.945 0 0 1-4.077 1.3c-.26 0-.522-.015-.781-.044a9.867 9.867 0 0 0 5.032 1.359V18z"></path></svg></a><a href="https://www.linkedin.com/company/yoctol/" target="_blank" rel="noopener noreferrer" style="margin-left:8px"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#FFF" fill-rule="nonzero" d="M1.5 0h21A1.5 1.5 0 0 1 24 1.5v21a1.5 1.5 0 0 1-1.5 1.5h-21A1.5 1.5 0 0 1 0 22.5v-21A1.5 1.5 0 0 1 1.5 0zm6.086 19.636V9.281H4.368v10.355h3.218zM5.944 7.801A1.877 1.877 0 0 0 7.82 5.925 1.876 1.876 0 1 0 5.945 7.8zm13.697 11.835v-5.679c0-2.788-.602-4.933-3.861-4.933-1.565 0-2.615.859-3.045 1.672h-.043V9.281H9.604v10.355h3.216v-5.123c0-1.35.258-2.658 1.932-2.658 1.65 0 1.673 1.545 1.673 2.746v5.035h3.216z"></path></svg></a></div></div><div class="footer-product"><h4 class="title">Product</h4><div class="icons"><a href="https://yoctol.ai/creator" target="_blank" rel="noopener noreferrer" style="margin-top:1px;margin-right:10px"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><g fill="none" fill-rule="nonzero"><path d="M-1-2h24v24H-1z"></path><path fill="#FFF" d="M4.129 12c.309 3.386 3.267 6.042 6.871 6.042 3.604 0 6.562-2.656 6.871-6.042H22c-.317 5.574-5.12 10-11 10S.317 17.574 0 12h4.129zM14 9a1 1 0 1 1 0 2 1 1 0 0 1 0-2zM8 9a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm14-9v10h-4.113V4.116H7.814A3.703 3.703 0 0 0 4.113 7.82V10H0V7.82A7.817 7.817 0 0 1 7.685.001L7.815 0H22z"></path></g></svg></a><a href="https://yoctol.ai/seeker" target="_blank" rel="noopener noreferrer" style="margin-right:10px"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="24" viewBox="0 0 22 24"><g fill="none" fill-rule="nonzero"><path d="M-1 0h24v24H-1z"></path><path fill="#FFF" d="M2.81 7.033l.004.004 3.123 3.137a.112.112 0 0 1 .017.137 5.957 5.957 0 0 0 .843 7.356 5.936 5.936 0 0 0 8.41.003 5.957 5.957 0 0 0 .839-7.355.112.112 0 0 1 .016-.138l3.122-3.136a.11.11 0 0 1 .158 0l.01.012c3.182 4.182 2.79 10.14-.915 13.86-4.1 4.117-10.77 4.115-14.87-.002-3.699-3.714-4.1-9.656-.941-13.836a.111.111 0 0 1 .184-.042zM8.5 11a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm5 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm5.942-7.854l.015.014a.175.175 0 0 1 0 .23L15.32 7.952a.138.138 0 0 1-.182.024 7.294 7.294 0 0 0-8.27-.002.138.138 0 0 1-.182-.024L2.544 3.384a.175.175 0 0 1 .014-.245c4.97-4.188 11.913-4.185 16.884.007z"></path></g></svg></a><a href="https://bottender.js.org/" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="24" viewBox="0 0 22 24"><g fill="none" fill-rule="evenodd"><path fill-rule="nonzero" d="M-1 0h24v24H-1z"></path><path fill="#FFF" d="M1.668 8.51c.258.075.548.159.867.244a9.055 9.055 0 0 0 .959 11.639l.206.202.102.098.022.139a2.63 2.63 0 0 1-.314 1.745c.351-.162.683-.36.99-.59l.227-.178.242-.196.264.162a9.343 9.343 0 0 0 4.898 1.379c5.115 0 9.276-4.107 9.276-9.154 0-.806-.107-1.607-.32-2.385.33.027.63.047.9.06.184.762.289 1.543.288 2.326 0 5.513-4.534 9.999-10.12 9.999a10.128 10.128 0 0 1-5.067-1.352c-1.039.78-2.395 1.228-3.574 1.289l-.269.007v-.845c.928-.002 1.807-.82 1.808-1.831 0-.057-.05-.113-.056-.17A9.891 9.891 0 0 1 1.668 8.51zM10 11a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm6 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2zM9.379.02c2.551.437 3.144 1.75 3.144 1.75s1.02-1.037 3.57-.6c2.302.394 3.731 6.79 3.99 8.047 1.233.338 1.946.614 1.916.775l-.143.719c-.074.409-4.997-.07-10.837-1.07C5.179 8.638.506 7.495.579 7.086l.144-.74c.03-.162.797-.185 2.075-.091C3.484 5.161 7.08-.374 9.378.02z"></path></g></svg></a></div></div><div class="mobile"><p class="text">© 2019 - PRESENT YOCTOL.AI ALL RIGHTS RESERVED.</p><a class="text" href="https://yoctol.ai/terms-of-use" target="_blank" rel="noopener noreferrer">Terms of Use</a><a class="text" href="https://yoctol.ai/privacy-policy" target="_blank" rel="noopener noreferrer" style="margin-left:16px">Privacy Policy</a></div></div></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '3498a488684b0324b9d56808fad17a33',
                indexName: 'bottender',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:en","version:1.0.5"]}
              });
            </script></body></html>